# 动态模型列表功能指南

## 概述

主题编辑器现在支持动态获取 AI 模型列表！🚀 这意味着您可以获取最新的可用模型，而不仅仅是预设的静态列表。

## 功能特性

### 🔄 动态模型获取
- **实时更新**: 通过 API 获取最新的可用模型列表
- **多供应商支持**: 支持 OpenRouter、OpenAI、Google Gemini 等多个供应商
- **自动回退**: 如果 API 调用失败，自动使用静态默认列表

### 📝 可编辑模型字段
- **自动完成**: 从预设列表中选择模型
- **手动输入**: 直接输入自定义模型名称
- **智能提示**: 显示模型类型（预设/自定义/动态）

### 🎛️ 灵活切换
- **静态/动态切换**: 一键切换模型列表类型
- **刷新功能**: 手动刷新获取最新模型
- **状态指示**: 清晰显示当前使用的列表类型

## 使用方法

### 1. 基本配置
1. 选择 AI 供应商
2. 输入有效的 API 密钥
3. 模型字段会显示默认的静态列表

### 2. 获取动态模型
1. 点击模型字段右侧的 🔄 **刷新按钮**
2. 系统会调用对应供应商的 API 获取最新模型列表
3. 成功后会自动切换到动态列表模式

### 3. 切换列表类型
- 点击 ↔️ **切换按钮** 在静态和动态列表之间切换
- 静态列表：使用预设的模型列表
- 动态列表：使用 API 获取的最新模型列表

### 4. 输入自定义模型
- 直接在模型字段中输入任何模型名称
- 系统会自动识别为自定义模型
- 支持新发布的模型或特殊模型名称

## 各供应商支持情况

### ✅ 完全支持动态获取
- **OpenRouter**: 通过 `/api/v1/models` 获取完整模型列表
- **OpenAI**: 通过 `/v1/models` 获取 GPT 系列模型
- **Google Gemini**: 通过 `/v1beta/models` 获取 Gemini 系列模型

### ⚠️ 部分支持
- **DeepSeek**: 使用 OpenAI 兼容格式获取
- **豆包**: 使用 OpenAI 兼容格式获取
- **自定义供应商**: 根据提供的 baseUrl 获取

### 📋 使用静态列表
- **Anthropic**: 没有公开的模型列表 API，使用预设列表
- **千问**: 使用预设列表（可根据 API 文档扩展）

## 界面说明

### 模型字段标签
- 🏷️ **预设**: 来自静态预设列表的模型
- 🏷️ **自定义**: 用户手动输入的模型名称
- 🏷️ **静态列表**: 当前使用预设的静态模型列表
- 🏷️ **动态列表**: 当前使用 API 获取的动态模型列表

### 操作按钮
- 🔄 **刷新按钮**: 获取最新的动态模型列表
- ↔️ **切换按钮**: 在静态和动态列表之间切换

### 状态提示
- 📋 静态模式：显示 "当前使用静态模型列表，点击刷新按钮获取最新模型"
- 🔄 动态模式：显示 "动态模型列表 (X 个模型)"

## 技术实现

### API 调用函数
```typescript
// 通用动态获取函数
export async function getAvailableModels(
  provider: string, 
  apiKey: string, 
  baseUrl?: string
): Promise<string[]>

// 各供应商专用函数
export async function getOpenRouterModels(apiKey: string): Promise<string[]>
export async function getOpenAIModels(apiKey: string): Promise<string[]>
export async function getGeminiModels(apiKey: string): Promise<string[]>
// ... 其他供应商
```

### 错误处理
- API 调用失败时自动回退到静态列表
- 显示友好的错误提示
- 保持界面可用性

### 性能优化
- 缓存动态获取的模型列表
- 避免重复的 API 调用
- 异步加载，不阻塞界面

## 最佳实践

### 1. 首次使用
- 建议先使用静态列表进行基本配置
- 确认 API 密钥有效后再获取动态列表

### 2. 模型选择
- 优先选择预设列表中的模型（经过验证）
- 使用动态列表获取最新模型
- 谨慎使用自定义模型名称

### 3. 性能考虑
- 不要频繁刷新模型列表
- 在网络较慢时使用静态列表
- 定期更新以获取新模型

## 故障排除

### 刷新按钮无响应
- 检查 API 密钥是否正确
- 确认网络连接正常
- 查看浏览器控制台错误信息

### 动态列表为空
- 可能是 API 暂时不可用
- 切换回静态列表继续使用
- 稍后重试刷新操作

### 自定义模型不工作
- 确认模型名称拼写正确
- 检查供应商是否支持该模型
- 参考供应商官方文档

---

🎯 通过动态模型列表功能，您可以始终使用最新的 AI 模型来生成主题！
